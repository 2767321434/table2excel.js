!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("ExcelJS")):"function"==typeof define&&define.amd?define(["ExcelJS"],t):"object"==typeof exports?exports.Table2Excel=t(require("ExcelJS")):e.Table2Excel=t(e.ExcelJS)}("undefined"!=typeof self?self:this,function(e){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=3)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.argb=t.mergeCells=t.cellPosition=t.columnIndex=t.saveAsExcel=void 0;var o=n(1),r=n(6),l=(t.saveAsExcel=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"table",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"xlsx",l=o.MIME_TYPES[n];if(!l)return void console.error(n+" file extension is not supported");e.xlsx.writeBuffer().then(function(e){(0,r.saveAs)(new Blob([e.buffer],{type:l}),t+"."+n)})},function(e){var t="A".charCodeAt(0);return String.fromCharCode(t+e-1)}),i=t.columnIndex=function(e){var t=void 0;if((e+=1)<=26)t=l(e);else{var n=e%26,o=Math.floor(e/26);t=0===n?l(o-1)+l(26):l(o)+l(n)}return t},a=t.cellPosition=function(e,t){return""+i(e)+(t+1)};t.mergeCells=function(e,t,n,o,r){var l=a(t,n),i=a(o,r);return e.mergeCells(l,i),e.getCell(l)},t.argb=function(e){var t=e.split("(")[1].split(")")[0].split(",").map(function(e,t){return 3===t?255*e:e});return 3===t.length&&t.push(255),t.unshift(t.pop()),t.map(function(e){var t=parseInt(e).toString(16);return 1===t.length?"0"+t:t}).join("").toUpperCase()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MIME_TYPES={xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},t.WIDTH_RATIO=.14},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),l=o(r),i=n(9),a=o(i),u=n(10),c=o(u),f=n(11),s=o(f),d=n(12),p=o(d),v=n(13),h=o(v);t.default={fontPlugin:l.default,fillPlugin:a.default,formPlugin:c.default,alignmentPlugin:s.default,hyperlinkPlugin:p.default,autoWidthPlugin:h.default}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),l=o(r),i=n(2),a=o(i),u=n(0),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(u);l.default.plugins=a.default,l.default.utils=c,t.default=l.default},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(5),a=o(i),u=n(0),c=n(1),f=n(2),s=o(f),d=["workbookCreated","worksheetCreated","worksheetCompleted","workcellCreated"],p={views:[{x:0,y:0,width:1e4,height:2e4,firstSheet:0,activeTab:1,visibility:"visible"}]},v={workbook:p,widthRatio:c.WIDTH_RATIO,plugins:[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(Object.values(s.default)))},h=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"table",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,e),this.tables=Array.from("string"==typeof n?document.querySelectorAll(n):n),this.options=Object.assign({},v,o),this.plugins={},d.forEach(function(e){t.plugins[e]=t.options.plugins.filter(function(t){return t[e]}).map(function(t){return t[e]})}),this.pluginContext={}}return l(e,[{key:"_invokePlugin",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.pluginContext=Object.assign({},this.pluginContext,n),this.plugins[e].forEach(function(e){return e.call(t,t.pluginContext)})}},{key:"toExcel",value:function(){var e=this,t=this.tables,n=this.options,o=new a.default.Workbook;return Object.assign(o,n),this._invokePlugin("workbookCreated",{workbook:o,tables:t}),t.forEach(function(t,n){var r=o.addWorksheet("Sheet "+(n+1));e._invokePlugin("worksheetCreated",{worksheet:r,table:t}),e.toSheet(t,r),e._invokePlugin("worksheetCompleted",{worksheet:r,table:t})}),this.workbook=o}},{key:"toSheet",value:function(e,t){var n=e.rows.length,o=0;if(e.rows.length>0)for(var r=0;r<e.rows[0].cells.length;r++)o+=e.rows[0].cells[r].colSpan;var l=[];Array.from(e.rows).forEach(function(e){var t=[];Array.from(e.cells).forEach(function(e){t.push({rowRange:{},colRange:{},el:e})}),l.push(t)});for(var i=[],a=0;a<n;a++){for(var c=[],f=0;f<o;f++)c.push({cell:null});i.push(c)}for(var s=0,d=0,p=0;p<n;p++){d=0;for(var v=0;v<o;v++)if(!i[p][v].cell){var h=1,g=1,b=l[s][d];if(null!=b||void 0!=b){h=b.el.rowSpan,g=b.el.colSpan,b.rowRange={from:p,to:p},b.colRange={from:v,to:v},d++;for(var w=p+h,y=p;y<w;y++)for(var m=v+g,k=v;k<m;k++)i[y][k].cell=b,b.colRange.to=k,b.rowRange.to=y}}s++}for(var x=0;x<l.length;x++)for(var _=l[x],j=0;j<_.length;j++){var O=_[j],E=O.rowRange,C=O.colRange,P=O.el,R=P.innerText,S=(0,u.mergeCells)(t,C.from,E.from,C.to,E.to),A=getComputedStyle(P);S.value=R,this._invokePlugin("workcellCreated",{workcell:S,cell:P,rowRange:E,colRange:C,cellStyle:A})}}},{key:"export",value:function(e,t){this.workbook||this.toExcel(),(0,u.saveAsExcel)(this.workbook,e,t)}}]),e}();t.default=h},function(t,n){t.exports=e},function(e,t,n){(function(n){var o,r,l;!function(n,i){r=[],o=i,void 0!==(l="function"==typeof o?o.apply(t,r):o)&&(e.exports=l)}(0,function(){"use strict";function t(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function o(e,t,n){var o=new XMLHttpRequest;o.open("GET",e),o.responseType="blob",o.onload=function(){a(o.response,t,n)},o.onerror=function(){console.error("could not download file")},o.send()}function r(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function l(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var i="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n&&n.global===n?n:void 0,a=i.saveAs||("object"!=typeof window||window!==i?function(){}:"download"in HTMLAnchorElement.prototype?function(e,t,n){var a=i.URL||i.webkitURL,u=document.createElement("a");t=t||e.name||"download",u.download=t,u.rel="noopener","string"==typeof e?(u.href=e,u.origin===location.origin?l(u):r(u.href)?o(e,t,n):l(u,u.target="_blank")):(u.href=a.createObjectURL(e),setTimeout(function(){a.revokeObjectURL(u.href)},4e4),setTimeout(function(){l(u)},0))}:"msSaveOrOpenBlob"in navigator?function(e,n,i){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,i),n);else if(r(e))o(e,n,i);else{var a=document.createElement("a");a.href=e,a.target="_blank",setTimeout(function(){l(a)})}}:function(e,t,n,r){if(r=r||open("","_blank"),r&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof e)return o(e,t,n);var l="application/octet-stream"===e.type,a=/constructor/i.test(i.HTMLElement)||i.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||l&&a)&&"object"==typeof FileReader){var c=new FileReader;c.onloadend=function(){var e=c.result;e=u?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=e:location=e,r=null},c.readAsDataURL(e)}else{var f=i.URL||i.webkitURL,s=f.createObjectURL(e);r?r.location=s:location.href=s,r=null,setTimeout(function(){f.revokeObjectURL(s)},4e4)}});i.saveAs=a.saveAs=a,void 0!==e&&(e.exports=a)})}).call(t,n(7))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},r=n(0);t.default={workcellCreated:function(e){var t=e.workcell,n=e.cellStyle,l=n.fontWeight;t.font=o({},t.font||{},{name:n.fontFamily,color:{argb:(0,r.argb)(n.color)},bold:"bold"===l||+l>600})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},r=n(0);t.default={workcellCreated:function(e){var t=e.workcell,n=e.cellStyle,l=(0,r.argb)(n.backgroundColor);t.fill="00000000"===l?o({},t.fill||{},{type:"pattern",pattern:"none"}):o({},t.fill||{},{type:"pattern",pattern:"solid",fgColor:{argb:l}})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={workcellCreated:function(e){var t=e.workcell,n=e.cell,o=n.children[0];o&&["INPUT","SELECT","TEXTAREA"].includes(o.tagName)&&(t.value=o.value)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},r=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=["right","left","center","justify"],n=0;n<t.length;n++)if(e.includes(t[n]))return t[n]},l=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=["top","middle","bottom"],n=0;n<t.length;n++)if(e.includes(t[n]))return t[n];return{baseline:"middle",super:"top",sub:"bottom"}[e]};t.default={workcellCreated:function(e){var t=e.workcell,n=e.cellStyle,i=n.verticalAlign,a=n.textAlign;t.alignment=o({},t.alignment||{},{vertical:l(i),horizontal:r(a)})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={workcellCreated:function(e){var t=e.workcell,n=e.cell,o=n.children[0];o&&"A"===o.tagName&&(t.value={text:o.innerText,hyperlink:o.href})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={workcellCreated:function(e){var t=e.worksheet,n=e.colRange,o=(e.cell,e.cellStyle);n.from===n.to&&"auto"!==o.width&&(t.getColumn(n.from+1).width=+o.width.split("px")[0]*this.options.widthRatio)}}}]).default});
//# sourceMappingURL=table2excel.core.js.map